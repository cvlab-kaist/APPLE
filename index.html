<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Attribute-Preserving Pseudo-Labeling for Diffusion-Based Face Swapping</title>
    <meta name="description"
        content="Project page for APPLE: Attribute-Preserving Pseudo-Labeling for Diffusion-Based Face Swapping">

    <!-- Fonts and Icons -->
    <link rel="stylesheet"
        href="https://cdn.jsdelivr.net/gh/wanteddev/wanted-sans@v1.0.1/packages/wanted-sans/fonts/webfonts/variable/split/WantedSansVariable.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <!-- Custom CSS -->
    <link rel="stylesheet" href="style.css">

</head>

<body>

    <!-- Sidebar Navigation -->
    <div class="sidebar">
        <a href="#overview" class="sidebar-item">
            <div class="sidebar-dot"></div>
            <span class="sidebar-label">Overview</span>
        </a>
        <a href="#framework" class="sidebar-item">
            <div class="sidebar-dot"></div>
            <span class="sidebar-label">Overall Framework</span>
        </a>
        <a href="#results" class="sidebar-item">
            <div class="sidebar-dot"></div>
            <span class="sidebar-label">Results</span>
        </a>
        <a href="#ablation" class="sidebar-item">
            <div class="sidebar-dot"></div>
            <span class="sidebar-label">Ablation</span>
        </a>
        <a href="#citation" class="sidebar-item">
            <div class="sidebar-dot"></div>
            <span class="sidebar-label">Citation</span>
        </a>
    </div>

    <!-- Hero Section -->
    <section id="overview" class="hero-section">
        <div class="hero-container">
            <h1 class="hero-title">
                <span class="gradient-text">APPLE</span>:
                Attribute-Preserving Pseudo-Labeling for Diffusion-Based Face Swapping
            </h1>
            <p class="hero-status">arxiv 2026</p>

            <!-- Authors -->
            <div class="hero-authors">
                <span><a href="https://scholar.google.com/citations?user=A2PurdIAAAAJ&hl=en" target="_blank">Jiwon Kang<sup>1</sup></a></span>
                <span><a href="https://scholar.google.com/citations?user=IWvP0A4AAAAJ&hl=en" target="_blank">Yeji Choi<sup>1</sup></a></span>
                <span><a href="https://scholar.google.com/citations?user=0H3dcPoAAAAJ&hl=en" target="_blank">JoungBin Lee<sup>1</sup></a></span>
                <span><a href="https://scholar.google.com/citations?user=7cyLEQ0AAAAJ&hl=en/" target="_blank">Wooseok Jang<sup>1</sup></a></span>
                <span>Jinhyeok Choi<sup>1</sup></span> <br>
                <span>Taekeun Kang<sup>2</sup></span>
                <span>Yongjae Park<sup>2</sup></span>
                <span>Myungin Kim<sup>2</sup></span>
                <span>Seungryong Kim<sup>1</sup></span>
            </div>

            <div class="hero-affiliations">
                <span><sup>1</sup>KAIST AI</span>
                <span><sup>2</sup>SAMSUNG</span>
            </div>

            <br>

            <!-- Link Buttons -->
            <div class="hero-buttons">
                <a href="https://github.com/cvlab-kaist/APPLE" class="btn">
                    <i class="fa-solid fa-link"></i> Paper
                </a>
                <a href="https://github.com/cvlab-kaist/APPLE" class="btn btn-outline">
                    <i class="fa-solid fa-file-zipper"></i> Code (Coming Soon)
                </a>
                <a href="#citation" class="btn btn-outline">
                    <i class="fa-solid fa-quote-right"></i> BibTeX
                </a>
            </div>
        </div>

        <!-- Teaser Section -->
        <div class="teaser-container">
            <!-- TL;DR Box -->
            <div class="tldr-box">
                <div class="tldr-content">
                    <span class="tldr-label">TL;DR</span>
                    <p class="tldr-text">
                        We propose a diffusion-based teacher-student framework for face swapping, where teacher generates high-quality pseudo data that are then used to train a student model, <b>significantly improving attribute preservation compared to existing diffusion-based methods </b> while maintaining strong identity transfer.
</b>
                    </p>
                </div>
            </div>
            <br>
            <br>
            <div class="analysis-image-container-teaser">
                <picture>
                    <source srcset="assets/new_paper_figures/teaser.webp" type="image/webp">
                    <img src="assets/new_paper_figures/teaser.png"
                        class="analysis-image" alt="Teaser">
                </picture>
            </div>
            <p class="results-caption" style="text-align: center; width: 70%; margin: 0 auto;">
                <b>Teaser.</b> Our model, <b>APPLE</b> (<b>A</b>ttribute-<b>P</b>reserving <b>P</b>seudo-<b>L</b>ab<b>e</b>ling), successfully transfers the identity of a source (<b>top left</b>) onto a target (<b>bottom left</b>) while accurately preserving target attributes (e.g. pose, expression, skin tone, lighting) across ethnicity, input variations, and gender.
            </p>
        </div>
    </section>

    <!-- Abstract -->
    <section class="section alt-bg">
        <div class="container">
            <h2 class="section-title">Overview</h2>
            <p style="text-align: left;">
            Face swapping aims to transfer the identity from a source image to a target face while preserving attributes like pose, lighting, and makeup. However, existing diffusion-based methods, which often rely on inpainting, struggle to preserve these attributes faithfully because masking the face removes crucial visual cues.
            </p>
            <p style="text-align: left;">
            To address this, we propose <b>APPLE</b>, a teacher-student framework that generates high-quality pseudo-labels(triplets) to provide explicit supervision.
            </p>
            <ul
                style="list-style-type: disc; margin-left: 1.5rem; margin-bottom: 1.5rem; margin-top: 1.5rem; color: var(--color-text-main); font-size: 1.2rem; line-height: 1.625; text-align: left;">
                <li style="margin-bottom: 0.5rem;">
                    A <b>teacher model</b> is trained to produce attribute-preserving results without ground-truth data by:
                    <ul style="list-style-type: circle; margin-left: 1.5rem; margin-top: 0.5rem;">
                        <li>Reformulating face swapping as a <b>conditional deblurring</b> task to retain low-frequency attributes. (e.g. skin tone, lighting)</li>
                        <li>Introducing an <b>attribute-aware inversion</b> scheme to capture fine-grained details. (e.g. makeup, accessories)</li>
                    </ul>
                </li>
                <li>
                    A <b>student model</b> is then trained on these high-quality pseudo-labels(triplets) produced by teacher model, learning face swapping as a direct editing task to further enhance attribute preservation.
                </li>
            </ul>
        </div>
    </section>


    <!-- Framework Section -->
    <section id="framework" class="section">

        <div class="container">
            <h2 class="section-title">Overall Framework</h2>

            <div class="analysis-image-container">
                 <picture>
                    <source srcset="assets/new_paper_figures/framework.webp" type="image/webp">
                    <img src="assets/new_paper_figures/framework.png" alt="Framework Overview" class="analysis-image">
                </picture>
            </div>

            <div class="results-caption" style="text-align: left;">
                <p>
                    <b>Overall architecture of the proposed method.</b> We propose <b>APPLE</b>, a diffusion-based teacher-student framework that focuses on improving attribute-preservation. (a) To improve target-attribute preservation, we propose training a teacher with <i>conditional deblurring</i> rather than conditional inpainting widely used in existing works. (b) When constructing pseudo-triplet, we propose <i>attribute-aware inversion</i> which further improves attribute preservation in inference time. Note that inversion noise cannot be used during training due to its non-Gaussian property. (c) Student is trained with pseudo-triplet generated by teacher model. Thanks to pseudo-supervision, student even surpass the teacher, achieving state-of-the-art attribute preservation while maintaining high identity similarity.
                </p>
            </div>
        </div>
    </section>

    <!-- New Section 1 -->
    <section  class="section alt-bg">
        <div class="container">
            <h2 class="section-title">Comparison of conditioning methods : Inpainting vs Deblurring</h2>
            <div class="analysis-image-container">
                 <picture>
                    <source srcset="assets/new_paper_figures/condition2.webp" type="image/webp">
                    <img src="assets/new_paper_figures/condition2.png" alt="Comparison of conditioning methods" class="analysis-image">
                </picture>
            </div>
            <div class="results-caption" style="text-align: left;">
                <p>
                    Compared to conditional inpainting widely used in existing works, proposed conditional deblurring strategy achieves largely improved attribute (e.g. pose, lighting) preservation of targets.
                </p>
            </div>
        </div>
    </section>

    
    <!-- New Section 2 -->
    <section class="section">
        <div class="container">
            <h2 class="section-title">Comparison of conditioning configuration for inversion</h2>
            <div class="analysis-image-container">
                 <picture>
                    <source srcset="assets/new_paper_figures/inversion_noise_vis.webp" type="image/webp">
                    <img src="assets/new_paper_figures/inversion_noise_vis.png" alt="Comparison of conditioning configuration for inversion" class="analysis-image">
                </picture>
            </div>
            <div class="results-caption" style="text-align: left;">
                <p>
                    (Top) Visualization of target-inverted noise and random gaussian noise via PCA. When attribute-condition is used, inverted noise encodes more semantic information compared to the others. (Bottom) Results of face swapping when each inverted noise used. Using attribute-only conditioned noise (<strong>attribute-aware inversion</strong>) yields most make-up preserved results without introducing artifacts.
                </p>
            </div>
        </div>
    </section>

    <!-- Results Section -->
    <section id="results" class="section alt-bg">
        <div class="container">

            <!-- 1. Quantitative Results -->
            <div class="results-block">
                <h2 class="section-title">Quantitative Results</h2>
                <div id="carousel-quan" class="carousel-container">
                    <!-- Injected by JS -->
                </div>
            </div>

            <!-- 2. Qualitative Results -->
            <div class="results-block">
                <h2 class="section-title">Qualitative Results</h2>
                <div id="carousel-qual" class="carousel-container">
                    <!-- Injected by JS -->
                </div>
            </div>

        </div>
    </section>

    <section id="ablation" class="section">
        <div class="container">
            <h2 class="section-title">Ablation Study</h2>
            <div class="analysis-image-container">
                <picture>
                    <source srcset="assets/new_paper_figures/ablation_qual.webp" type="image/webp">
                    <img src="assets/new_paper_figures/ablation_qual.png" class="analysis-image" alt="Ablation Study">
                </picture>
            </div>
            <div class="results-caption" style="text-align: left;">
                <p>
                    The inpainting method fails to preserve the target image’s attributes. Applying deblurring (4th column) and attribute-aware inversion (5th column) progressively better maintain the target attributes. Overall quality including attribute-preserving is maximized on student (6th column).
                </p>
            </div>
        </div>
    </section>

    <!-- Citation Section -->
    <section id="citation" class="citation-section">
        <div class="container">
            <h2 class="section-title" style="font-size: 1.5rem; border: none; margin-bottom: 1rem;">Citation</h2>
            <div class="citation-block group">
                <button onclick="copyBibtex()" class="citation-copy-btn">
                    <i class="fa-regular fa-copy"></i> Copy
                </button>
                <pre class="citation-code"><code id="bibtex-text">@article{kang2026apple,
  title={Attribute-Preserving Pseudo-Labeling for Diffusion-Based Face Swapping},
  author={Kang, Jiwon and Choi, Yeji and Lee, JoungBin and Jang, Wooseok and Choi, Jinhyeok and Kang, Taekeun and Park, Yongjae and Kim, Myungin and Kim, Seungryong},
  journal={arXiv preprint},
  year={2026}
}</code></pre>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <p>APPLE : Attribute-Preserving Pseudo-Labeling for Diffusion-Based Face Swapping</p>
        </div>
    </footer>

    <script>
        // Generic Carousel Class
        class Carousel {
            constructor(containerId, data, renderItem) {
                this.container = document.getElementById(containerId);
                this.data = data;
                this.renderItem = renderItem;
                this.currentIndex = 0;
                this.totalSlides = data.length;

                this.init();
                
                window.addEventListener('resize', () => this.updateHeight());
                this.container.addEventListener('load', () => this.updateHeight(), true);
            }

            init() {
                this.container.innerHTML = `
                    <div class="carousel-viewport">
                        <div class="carousel-track">
                            ${this.data.map(item => `<div class="carousel-slide">${this.renderItem(item)}</div>`).join('')}
                        </div>
                    </div>
                    <button class="carousel-nav-btn prev"><i class="fa-solid fa-chevron-left"></i></button>
                    <button class="carousel-nav-btn next"><i class="fa-solid fa-chevron-right"></i></button>
                    <div class="carousel-dots">
                        ${this.data.map((_, i) => `<button class="carousel-dot ${i === 0 ? 'active' : ''}" data-index="${i}"></button>`).join('')}
                    </div>
                `;

                this.track = this.container.querySelector('.carousel-track');
                this.dots = this.container.querySelectorAll('.carousel-dots button');

                this.container.querySelector('.carousel-nav-btn.prev').onclick = () => this.move(-1);
                this.container.querySelector('.carousel-nav-btn.next').onclick = () => this.move(1);
                this.dots.forEach((dot, i) => dot.onclick = () => this.goTo(i));
                this.update();
            }

            move(direction) {
                this.currentIndex = (this.currentIndex + direction + this.totalSlides) % this.totalSlides;
                this.update();
            }

            goTo(index) {
                this.currentIndex = index;
                this.update();
            }

            update() {
                this.track.style.transform = `translateX(-${this.currentIndex * 100}%)`;
                this.dots.forEach((dot, i) => {
                    dot.className = `carousel-dot ${i === this.currentIndex ? 'active' : ''}`;
                });
                this.updateHeight();
            }
            
            updateHeight() {
                const slides = this.container.querySelectorAll('.carousel-slide');
                if (slides[this.currentIndex]) {
                    const height = slides[this.currentIndex].offsetHeight;
                    this.container.querySelector('.carousel-viewport').style.height = `${height}px`;
                }
            }
        }

        const quantitativeData = [
            {
                title: "Quantitative Results on FFHQ",
                desc: "<b>APPLE</b> achieves the best FID and superior attribute preservation, as evidenced by low pose and expression errors, while maintaining competitive identity transferability.",
                table: `
                    <table class="quant-table" role="role">
                        <thead>
                            <tr>
                                <th>Model</th>
                                <th>FID↓</th><th>ID Sim.↑</th><th>ID Retrieval↑<br>(Top1 / Top5)</th><th>Pose↓</th><th>Expr.↓</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr><td colspan="6" style="text-align: center;"><b>GAN-Based</b></td></tr>
                            <tr><td>SimSwap</td><td>18.54</td><td>0.55</td><td>94.10 / 99.00</td><td>3.11</td><td>1.73</td></tr>
                            <tr><td>CSCS</td><td>11.00</td><td>0.65</td><td>99.00 / 99.50</td><td>3.64</td><td>1.44</td></tr>
                            <tr><td>MegaFS</td><td>12.83</td><td>0.49</td><td>79.6 / 86.3</td><td>4.40</td><td>1.11</td></tr>
                            <tr><td>FaceDancer</td><td>3.80</td><td>0.51</td><td>89.70 / 96.50</td><td>2.23</td><td>0.74</td></tr>
                            <tr><td>HiFiFace</td><td>11.81</td><td>0.50</td><td>85.40 / 93.40</td><td>3.20</td><td>1.34</td></tr>
                            <tr><td>InfoSwap</td><td>5.00</td><td>0.54</td><td>91.40 / 97.50</td><td>4.33</td><td>1.40</td></tr>
                            <tr><td>E4S</td><td>12.13</td><td>0.49</td><td>78.30 / 87.80</td><td>4.39</td><td>1.29</td></tr>
                            <tr><td colspan="6" style="border: none; height: 10px;"></td></tr>
                            <tr><td colspan="6" style="text-align: center;"><b>Diffusion-Based</b></td></tr>
                            <tr><td>DiffSwap</td><td>6.84</td><td>0.34</td><td>41.92 / 63.09</td><td>2.63</td><td>1.20</td></tr>
                            <tr><td>DiffFace</td><td>8.59</td><td>0.54</td><td>90.70 / 95.90</td><td>3.67</td><td>1.24</td></tr>
                            <tr><td>FaceAdapter</td><td>13.03</td><td>0.52</td><td>87.00 / 93.20</td><td>5.12</td><td>1.38</td></tr>
                            <tr><td>REFace</td><td>7.22</td><td>0.60</td><td>97.60 / 99.40</td><td>3.67</td><td>1.08</td></tr>
                            <tr><td colspan="6" style="border: none; height: 10px;"></td></tr>
                            <tr><td><b>APPLE (Teacher)</b></td><td>3.68</td><td>0.54</td><td>90.40 / 96.70</td><td>2.07</td><td>0.70</td></tr>
                            <tr><td><b>APPLE (Student)</b></td><td><b>2.18</b></td><td>0.54</td><td>90.50 / 97.00</td><td><b>1.85</b></td><td><b>0.64</b></td></tr>
                        </tbody>
                    </table>
                `
            },
            {
                title: "Ablation of Teacher Model",
                desc: "Applying the proposed components sequentially leads to gradual performance improvements. In particular, the attribute-aware inversion module substantially improves FID, pose, and expression metrics while maintaining identity similarity at a comparable level.",
                table: `
                     <table class="quant-table" role="role">
                        <thead>
                            <tr>
                                <th>Model</th>
                                <th>FID↓</th><th>ID Sim.↑</th><th>ID Retrieval (Top1 / Top5)↑</th><th>Pose↓</th><th>Expr.↓</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr><td>Inpainting (Baseline)</td><td>11.00</td><td>0.54</td><td>92.80 / 96.90</td><td>3.37</td><td>1.01</td></tr>
                            <tr><td>Deblurring</td><td>4.20</td><td>0.53</td><td>89.50 / 96.20</td><td>2.58</td><td>0.79</td></tr>
                            <tr><td><b>Deblurring + Inv.</b></td><td><b>3.68</b></td><td>0.54</td><td>90.40 / 96.70</td><td><b>2.07</b></td><td><b>0.70</b></td></tr>
                        </tbody>
                    </table>
                `
            },
            {
                title: "Ablation of Conditioning Configurations for Inversion",
                desc: "For inversion, using attribute-only condition improves FID, pose and expression effectively while not sacrificing identity transferability.",
                table: `
                     <table class="quant-table" role="role">
                        <thead>
                            <tr>
                                <th>Condition config.</th>
                                <th>FID↓</th><th>ID Sim.↑</th><th>ID Retrieval (Top1 / Top5)↑</th><th>Pose↓</th><th>Expr.↓</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr><td>Baseline</td><td>4.20</td><td>0.53</td><td>89.50 / 96.20</td><td>2.58</td><td>0.79</td></tr>
                            <tr><td colspan="6" style="border: none; height: 10px;"></td></tr>
                            <tr><td>+ None</td><td>6.20</td><td>0.52</td><td>87.90 / 95.80</td><td><b>2.03</b></td><td>0.74</td></tr>
                            <tr><td>+ Identity-only</td><td>10.02</td><td>0.53</td><td>90.50 / 95.90</td><td>2.57</td><td>0.83</td></tr>
                            <tr><td><b>+ Attribute-only</b></td><td><b>3.68</b></td><td>0.54</td><td>90.40 / 96.70</td><td>2.07</td><td><b>0.70</b></td></tr>
                            <tr><td>+ Full</td><td>10.51</td><td>0.53</td><td>89.10 / 93.80</td><td>3.13</td><td>0.99</td></tr>
                        </tbody>
                    </table>
                `
            },
            {
                title: "Ablation of Pseudo-label Quality",
                desc: "To compare the quality of pseudo-labels produced by APPLE(Teacher), we compare the performance of student model trained by pseudo-labels constructed by FaceDancer and APPLE(Teacher). The student model trained on our pseudo-triplet achieves superior attribute-preserving results indicated by lower pose and expression consistency, while maintaining comparable identity similarity. Results indicate that our teacher model serves as a more effective teacher.",
                table: `
                     <table class="quant-table" role="role">
                        <thead>
                            <tr>
                                <th>Teacher model</th>
                                <th>FID↓</th><th>ID Sim.↑</th><th>ID Retrieval (Top1 / Top5)↑</th><th>Pose↓</th><th>Expr.↓</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr><td>FaceDancer</td><td>2.47</td><td>0.53</td><td>87.50 / 95.60</td><td>2.07</td><td>0.65</td></tr>
                            <tr><td><b>APPLE (Teacher)</b></td><td><b>1.98</b></td><td>0.53</td><td>88.60 / 95.80</td><td><b>1.77</b></td><td><b>0.62</b></td></tr>
                        </tbody>
                    </table>
                `
            }
        ];

        const qualitativeData = [
            {
                title: "Qualitative Comparison on FFHQ",
                desc: "Compared to existing baselines, <b>APPLE</b> effectively preserves the target image’s attributes while faithfully transferring the source identity.",
                image: "assets/new_paper_figures/main_qual.png",
                webp_image: "assets/new_paper_figures/main_qual.webp"
            },
            /*
            {
                title: "Pseudo-label Quality Comparison",
                desc: "We compare two student models trained on pseudo-triplet generated by FaceDancer and APPLE (Teacher). Results demonstrate that student trained by APPLE (Teacher) more faithfully preserves the target attributes.",
                image: "assets/new_paper_figures/dataset_ablation.png",
                webp_image: "assets/new_paper_figures/dataset_ablation.webp"
            },
            */
            {
                title: "Qualitative Results on FFHQ (Appendix)",
                desc: "Additional qualitative results on FFHQ.",
                image: "assets/new_paper_figures/supple_qual_1.png",
                webp_image: "assets/new_paper_figures/supple_qual_1.webp"
            },
            {
                title: "Qualitative Results on FFHQ (Appendix)",
                desc: "Additional qualitative results on FFHQ.",
                image: "assets/new_paper_figures/supple_qual_2.png",
                webp_image: "assets/new_paper_figures/supple_qual_2.webp"
            },
            {
                title: "Qualitative Results on FFHQ (Appendix)",
                desc: "Additional qualitative results on FFHQ.",
                image: "assets/new_paper_figures/supple_qual_3.png",
                webp_image: "assets/new_paper_figures/supple_qual_3.webp"
            },
            {
                title: "Qualitative Results on FFHQ (Appendix)",
                desc: "Additional qualitative results on FFHQ.",
                image: "assets/new_paper_figures/supple_qual_4.png",
                webp_image: "assets/new_paper_figures/supple_qual_4.webp"
            }
        ];


        // Render Functions
        function renderQuantitative(item) {
            return `
                <div class="results-slide-content">
                    <h3 class="results-slide-title">${item.title}</h3>
                    <div class="analysis-image-container" style="padding: 0 20px; background: transparent; border: none;">
                        <div class="quant-table-wrapper">
                            ${item.table}
                        </div>
                    </div>
                    <div class="results-caption">
                        <p>${item.desc || ''}</p>
                    </div>
                </div>`;
        }

        function renderImageCard(item) {
            return `
                <div class="results-slide-content">
                    <h3 class="results-slide-title">${item.title}</h3>
                    <div class="analysis-image-container">
                        <picture>
                            <source srcset="${item.webp_image}" type="image/webp">
                            <img src="${item.image}" class="analysis-image" alt="${item.title}">
                        </picture>
                    </div>
                    <div class="results-caption" style="text-align: left;">
                        <p>${item.desc}</p>
                    </div>
                </div>`;
        }
        
        function copyBibtex() {
            const text = document.getElementById('bibtex-text').innerText;
            navigator.clipboard.writeText(text).then(() => {
                const btn = document.querySelector('.citation-copy-btn');
                const original = btn.innerHTML;
                btn.innerHTML = '<i class="fa-solid fa-check"></i> Copied!';
                setTimeout(() => {
                    btn.innerHTML = original;
                }, 2000);
            });
        }
        
        function initScrollSpy() {
            const sections = document.querySelectorAll('section[id]');
            const sidebarLinks = document.querySelectorAll('.sidebar-item');
            const sidebar = document.querySelector('.sidebar');

            const observerOptions = {
                root: null,
                rootMargin: '-50% 0px -50% 0px',
                threshold: 0
            };

            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        const id = entry.target.getAttribute('id');
                        sidebarLinks.forEach(link => link.classList.remove('active'));
                        const activeLink = document.querySelector(`.sidebar-item[href="#${id}"]`);
                        if (activeLink) {
                            activeLink.classList.add('active');
                            const linkRect = activeLink.getBoundingClientRect();
                            const sidebarRect = sidebar.getBoundingClientRect();
                            const relativeTop = linkRect.top - sidebarRect.top;
                            sidebar.style.setProperty('--active-position', `${relativeTop - 32}px`);
                        }
                    }
                });
            }, observerOptions);

            sections.forEach(section => observer.observe(section));
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', () => {
            new Carousel('carousel-quan', quantitativeData, renderQuantitative);
            new Carousel('carousel-qual', qualitativeData, renderImageCard);
            initScrollSpy();
        });

    </script>
</body>

</html>